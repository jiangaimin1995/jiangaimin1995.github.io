<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>R学习|基于ggplot2，使用金字塔图可视化临床研究中的不良事件（AE）</title>
    <url>/year/021842331.html</url>
    <content><![CDATA[<p>对于临床研究而言，疗效和安全性是大家最关心的问题。那么，如何在一个临床研究中将读者们最关心的问题有效的展示出来至关重要。这期我们选择临床研究中的不良事件（AE）。通常来讲，在绝大多数文章中作者一般会使用表格来呈现不同干预组参与者不同AE的构成比。</p>
<span id="more"></span>

<p><img src="https://mmbiz.qpic.cn/mmbiz_png/EKDJKJSia78QXt8Qj2vicOSjJtyrVG8iaKLd3LiceuzGX3vH49R0ViazdPYbcef3QNwMpYKvzjrcbicKHvNVkPUDZPsg/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1" alt="John, Thomas et al. “Three-Year Safety, Tolerability, and Health-Related Quality of Life Outcomes of Adjuvant Osimertinib in Patients With Resected Stage IB to IIIA EGFR-Mutated NSCLC: Updated Analysis From the Phase 3 ADAURA Trial.” Journal of thoracic oncology : official publication of the International Association for the Study of Lung Cancer vol. 18,9 (2023): 1209-1221. doi:10.1016/j.jtho.2023.05.015"></p>
<p>例如上面提到的文章，作者在表格中展示了不同治疗组参与者任何级别和3级及以上AE的构成比。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/EKDJKJSia78QXt8Qj2vicOSjJtyrVG8iaKLDPKwc7Yib1RCXF6yReia22BzmbvCnRTpEDhcL8uia31PwZaJzGguO2CwA/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>此外，作者也通过类似于金字塔图的形式来展示一些AE在不同组中的发生情况。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/EKDJKJSia78QXt8Qj2vicOSjJtyrVG8iaKLddAhaBJwwv6V2uicCktat2iaoOGILfYliaudnwbUribs8GCP0l16dayO6Q/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>上图貌似是从Prism中绘制得到的。那么，如何用R来达到上面的效果呢，确切的来说，是通过ggplot2。</p>
<p>要实现上一目标，我们得将目光转向金字塔图。那什么是金字塔图？金字塔图又有什么作用呢？</p>
<p><strong>金字塔图是一种图形表达方式，其形状类似金字塔，从顶部开始逐渐向底部扩展。它通常用于展示层次关系、分层结构或者逐级递减的数据。金字塔图在商业、统计学、人口学和市场营销等领域中被广泛应用。</strong></p>
<p><strong>金字塔图的基本特征包括：</strong></p>
<ol>
<li><p>层次结构： 金字塔图的形状呈金字塔状，从上到下逐渐变宽，表示数据的逐级递减或者逐级分层。</p>
</li>
<li><p>比例表达： 金字塔图的每个层次都代表了不同的数值或者占比，并且可以通过宽度或高度的变化来表示相对的数量。</p>
</li>
</ol>
<p><strong>金字塔图的作用包括：</strong></p>
<ol>
<li><p>展示层次结构： 金字塔图适用于展示具有明显层次结构的数据，例如组织层级、人口金字塔等。</p>
</li>
<li><p>比较占比：通过金字塔图，可以清晰地看到每个层次的占比情况，便于比较不同级别或群体之间的相对大小。</p>
</li>
<li><p>传达逐渐减少的趋势：当数据呈现逐级递减的趋势时，金字塔图能够生动地表达这种递减关系。</p>
</li>
<li><p>人口金字塔：金字塔图在人口学中被广泛用于展示不同年龄层次和性别的人口分布，形成人口金字塔，用于分析人口结构和趋势。</p>
</li>
</ol>
<p>在R中，可以通过apyramid包来绘制金字塔图。相关内容有很多推送，不再赘述。小编选择使用ggplot2来实现金字塔图的可视化，是因为后者具有更强的可编辑性。</p>
<p>以下是小编使用ggplot2绘制的金字塔图，来展示上面提到的表格中不同治疗组任意级别AE的发生构成比。</p>
<p>需要注意的是，里面的数据为小编随意生成，并不是原始表格中的数据。但值得肯定的是，下图可以更加清晰的来展示AE。也推荐大家用在自己的文章中，提升一点儿逼格。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/EKDJKJSia78QXt8Qj2vicOSjJtyrVG8iaKL0goXU4MIG7FLm2A4d27FrrCLVZySfGTulyPGWgs5K6ORFcOFor2qkA/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<hr>
<p>下面我们看下具体是如何实现的吧。</p>
<h2 id="加载包"><a href="#加载包" class="headerlink" title="加载包"></a>加载包</h2><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 加载包</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span><span class="comment">#可视化</span></span><br><span class="line">library<span class="punctuation">(</span>ggsci<span class="punctuation">)</span><span class="comment">#配色</span></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span><span class="comment">#数据操纵</span></span><br><span class="line">library<span class="punctuation">(</span>ggrepel<span class="punctuation">)</span><span class="comment">#文本注释</span></span><br></pre></td></tr></table></figure>



<h2 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h2><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 读入数据</span></span><br><span class="line">data<span class="operator">&lt;-</span>read.delim<span class="punctuation">(</span><span class="string">&quot;pyramid.txt&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 数据处理-宽数据格式转变为长数据格式</span></span><br><span class="line">data<span class="operator">%&gt;%</span></span><br><span class="line">  pivot_longer<span class="punctuation">(</span>cols <span class="operator">=</span> <span class="number">2</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">               names_to <span class="operator">=</span> <span class="string">&quot;Arm&quot;</span><span class="punctuation">,</span></span><br><span class="line">               values_to <span class="operator">=</span> <span class="string">&quot;Count&quot;</span><span class="punctuation">)</span><span class="operator">-&gt;</span>data2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算不同干预组不同AE的构成比</span></span><br><span class="line">data2<span class="operator">%&gt;%</span></span><br><span class="line">  mutate<span class="punctuation">(</span>Percent<span class="operator">=</span></span><br><span class="line">           ifelse<span class="punctuation">(</span>Arm<span class="operator">==</span><span class="string">&quot;Osimertinib&quot;</span><span class="punctuation">,</span>Count<span class="operator">/</span><span class="number">337</span><span class="punctuation">,</span>Count<span class="operator">/</span><span class="number">343</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">-&gt;</span>data2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 产生标签，将构成比转换为百分数</span></span><br><span class="line">data2<span class="operator">%&gt;%</span></span><br><span class="line">  mutate<span class="punctuation">(</span>label<span class="operator">=</span>sprintf<span class="punctuation">(</span><span class="string">&quot;%.0f%%&quot;</span><span class="punctuation">,</span> Percent <span class="operator">*</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         Count<span class="operator">=</span>ifelse<span class="punctuation">(</span>Arm<span class="operator">==</span><span class="string">&quot;Osimertinib&quot;</span><span class="punctuation">,</span>Count<span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="operator">*</span>Count<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">-&gt;</span>Label</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 绘图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>reorder<span class="punctuation">(</span>AE<span class="punctuation">,</span>Count<span class="punctuation">)</span><span class="punctuation">,</span>y<span class="operator">=</span>Count<span class="punctuation">,</span>fill<span class="operator">=</span>Arm<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span><span class="comment">#绘制图层</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>data <span class="operator">=</span> data2 <span class="operator">%&gt;%</span> filter<span class="punctuation">(</span>Arm <span class="operator">==</span> <span class="string">&quot;Osimertinib&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>alpha<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">)</span> <span class="operator">+</span><span class="comment">#奥希替尼组条形图</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>data <span class="operator">=</span> data2 <span class="operator">%&gt;%</span> filter<span class="punctuation">(</span>Arm <span class="operator">==</span> <span class="string">&quot;Placebo&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="comment">#安慰剂组条形图，绘制到坐标轴左半部分</span></span><br><span class="line">                 mapping <span class="operator">=</span> aes<span class="punctuation">(</span>y <span class="operator">=</span>Count<span class="operator">*</span> <span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>alpha<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span><span class="comment">#坐标轴翻转</span></span><br><span class="line">  <span class="comment"># 设置坐标轴范围</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">250</span><span class="punctuation">,</span><span class="number">350</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                     breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">250</span><span class="punctuation">,</span><span class="number">350</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                     labels <span class="operator">=</span> <span class="built_in">abs</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">250</span><span class="punctuation">,</span><span class="number">350</span><span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_jco<span class="punctuation">(</span>name<span class="operator">=</span><span class="string">&quot;Treatment Arm&quot;</span><span class="punctuation">,</span><span class="comment">#设置主题及图例标题和标签</span></span><br><span class="line">                 labels<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Osimertinib (n=337)&quot;</span><span class="punctuation">,</span><span class="string">&quot;Placebo (n=343)&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="string">&quot;Count of patients with AE&quot;</span><span class="punctuation">,</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;Most Common Investigator-Assessed Possibly Causally Related AEs Reported in More Than or Equal to 5% of Patients</span></span><br><span class="line"><span class="string">Treated With Osimertinib or Placebo, by Maximum CTCAE Grade&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Pyramid plot to visualize the AEs in clinical study&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_classic<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.line.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line.x <span class="operator">=</span> element_line<span class="punctuation">(</span>linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold.italic&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                  face <span class="operator">=</span> <span class="string">&quot;bold.italic&quot;</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.caption <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    face <span class="operator">=</span> <span class="string">&quot;italic&quot;</span><span class="punctuation">,</span>hjust <span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>linewidth<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">+</span><span class="comment">#添加辅助线</span></span><br><span class="line">  geom_text_repel<span class="punctuation">(</span>data <span class="operator">=</span> Label <span class="operator">%&gt;%</span> filter<span class="punctuation">(</span>Arm <span class="operator">==</span> <span class="string">&quot;Osimertinib&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="comment">#添加奥希替尼组AE构成比的文本注释</span></span><br><span class="line">                  aes<span class="punctuation">(</span>label <span class="operator">=</span> label<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                  force <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span></span><br><span class="line">                  nudge_y <span class="operator">=</span><span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">                  direction <span class="operator">=</span> <span class="string">&quot;x&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text_repel<span class="punctuation">(</span>data <span class="operator">=</span> Label <span class="operator">%&gt;%</span> filter<span class="punctuation">(</span>Arm <span class="operator">==</span> <span class="string">&quot;Placebo&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="comment">#安慰剂组注释</span></span><br><span class="line">                  aes<span class="punctuation">(</span>label <span class="operator">=</span> label<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                  force <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span></span><br><span class="line">                  nudge_y <span class="operator">=</span><span class="operator">-</span><span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">                  direction <span class="operator">=</span> <span class="string">&quot;x&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  hjust <span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>



<p><img src="https://mmbiz.qpic.cn/mmbiz_png/EKDJKJSia78QXt8Qj2vicOSjJtyrVG8iaKL0goXU4MIG7FLm2A4d27FrrCLVZySfGTulyPGWgs5K6ORFcOFor2qkA/640?wx_fmt=png&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1" alt="生成图片"></p>
<p>本次的分享就到这里了！</p>
]]></content>
      <tags>
        <tag>R</tag>
        <tag>ggplot2</tag>
      </tags>
  </entry>
  <entry>
    <title>临床预测模型|2.预测模型的研究设计相关问题（一）</title>
    <url>/year/021961239.html</url>
    <content><![CDATA[<p>在之前的很多篇推送中，我们探讨了很多关于临床预测模型的内容。接下来，我们将结合统计大神Ewout W. Steyerberg的著作—Clinical Prediction Models, A Practical Approach to Development, Validation, and Updating，对临床预测模型的理论和实践进行系统的学习。</p>
<p>在这次的内容中，我们将系统了解预测模型的研究设计相关问题。</p>
<hr>
<p>在本章中，我们主要学习预测研究设计中的几个问题，包括选择队列研究所需要的受试者或患者以及来自单一中心、来自注册登记或随机对照试验的病例的优势和局限性；预测模型中选择预测因子和结局变量的问题；此外，还有一个重要的问题是研究需要多大规模（样本量）才能支撑足够的统计学检验效能。</p>
<h2 id="预后研究"><a href="#预后研究" class="headerlink" title="预后研究"></a><strong>预后研究</strong></h2><p>预后研究本质上是纵向研究，最常在患者队列中进行，随着时间的推移对患者进行随访以观察结局（或“事件”或“终点”）的发生。这个队列的定义是基于一个或多个特定的特征，比如患有某种疾病、居住在特定地方、年龄在一定范围内，或者仅仅是活产。几种队列研究类型可以用于预后模型的开发，最常见的可能是单中心回顾性队列研究。例如，识别医院病历记录中特定日期范围之间的患者，并对这些患者的病历资料向前追溯。</p>
<span id="more"></span>

<p><img src="https://pic1.zhimg.com/80/v2-a22f5b91137bd111d5617820de609eb0_1440w.webp" alt="针对预后研究的研究设计"></p>
<h3 id="回顾性设计"><a href="#回顾性设计" class="headerlink" title="回顾性设计"></a><strong>回顾性设计</strong></h3><p>回顾性研究设计的优点包括其简单性和可行性。由于在单个中心的病人记录通常可以轻松地搜索，特别是在现代医院信息系统或电子病历的帮助下，因此它是一个相对成本较低的设计。一个局限性是正确识别病人，这必须在事后完成。如果某些信息缺失或记录不正确，这可能导致选择性偏倚。同样，预测因子的记录必须是可靠的，才能用于预测建模。最后，结果评估必须是可靠的。对于硬性终点如存活情况来说，这可能相对简单，因为一些死亡情况将从医院记录中知晓。但是，为了完整评估存活状况，通常还需要从全国统计局获得额外的生存状态确认。其他结果，例如与功能状态相关的结果，在我们希望进行分析的时间点可能不可用。最后，单中心研究可能受到样本量的限制，这是预测研究中的一个关键问题。</p>
<h3 id="示例：预测食管癌的早期死亡率"><a href="#示例：预测食管癌的早期死亡率" class="headerlink" title="示例：预测食管癌的早期死亡率"></a><strong>示例：预测食管癌的早期死亡率</strong></h3><p>对 1997 年 1 月 1 日至 2003 年 12 月 31 日期间在同一机构接受治疗的 120 名患者进行了回顾性分析。患者接受姑息治疗，这意味着治疗可以缓解症状，但不会改变病程。患者由于吞咽困难植入了食管支架。作者研究了 30 天死亡率，大概出现在约 10%（n &#x3D; 12）的患者中。预测因素是营养状况（低血清白蛋白水平、低BMI）和体能状态（WHO 等级）。</p>
<h3 id="前瞻性设计"><a href="#前瞻性设计" class="headerlink" title="前瞻性设计"></a><strong>前瞻性设计</strong></h3><p>在前瞻性研究中，我们可以更好地设定纳入和排除标准。研究者与研究人群一起随着时间推移（因此被称为“前瞻性研究”）。在前瞻性研究中，我们可以使用清晰一致的预测因子，并在预定义的时间点评估患者预后。因此，前瞻性队列研究优于回顾性系列研究。纯粹用于预测模型的前瞻性队列研究很少见。更常见的设计是将预测研究应用于随机临床试验 (RCT) 的数据，或前瞻性前后试验的数据。优点在于患者选择明确，预测因子记录前瞻性，通常会进行质量控制，并且对终点进行前瞻性评估。临床试验的样本量通常相当大。然而，来自 (随机) 试验数据的限制可能在于患者的选择。临床试验通常会使用严格的纳入和排除标准，这可能会限制由此开发的模型的普遍性。另一方面，RCT 通常会在多个中心进行，有时来自多个国家或地区。多中心设计的优势在于，需要就预测因子和结局的定义问题达成共识，并且会提高研究结果的可推广性。这与单中心研究形成对比，后者仅反映特定环境中的关联。一个争论的话题是，我们是否应该只使用来自随机分配到常规治疗或安慰剂（“对照组”）的 RCT 患者。如果我们结合随机分组，我们假设没有特定的亚组效应与预后模型相关。这通常可能是合理的。治疗的预后影响通常比其他预测因子的预后影响小。如果预测模型旨在支持治疗决策，最简单且相当合理的方法是将治疗作为主要效应纳入。</p>
<h3 id="示例：预测食管癌的长期死亡率"><a href="#示例：预测食管癌的长期死亡率" class="headerlink" title="示例：预测食管癌的长期死亡率"></a><strong>示例：预测食管癌的长期死亡率</strong></h3><p>在另一项食管癌结局研究中，来自 RCT（“SIREC”，n &#x3D; 209 ）的数据与其他前瞻性收集的数据（n &#x3D; 396） 相结合。研究者研究了支架置入和放疗姑息治疗后的长期死亡率。作者结合了年龄、性别、肿瘤长度、转移和 WHO 表现评分，提出了一个简单的预后评分。</p>
<h3 id="注册登记研究的设计"><a href="#注册登记研究的设计" class="headerlink" title="注册登记研究的设计"></a><strong>注册登记研究的设计</strong></h3><p>预测性研究通常利用登记数据进行，例如癌症登记数据或保险数据库。这些数据的收集虽然是前瞻性的，但最初目的并非用于预测研究。数据细节的不足可能限制了预测性分析。例如，美国著名的癌症登记系统 (Surveillance, Epidemiology and End Results, SEER) 包含癌症发病率、死亡率、患者人口统计学特征和肿瘤分期等信息。它已与 Medicare 数据库链接，以获取关于合并症和治疗 (手术、化疗、放射治疗) 的信息。社会经济地位通常基于可用区域的中位收入，属于汇总数据。SEER-Medicare 数据库不包含详细的PS信息，而这对于医疗决策和生存期评估至关重要。此外，SEER数据库中的肿瘤分期可能存在一些测量偏差。由于通常没有提前确定的评估，与回顾性研究类似，基于登记数据的预测性分析存在着同样的限制。因此，研究结局通常仅限于生存率，尽管有时也可以从中推导出其他不良事件。利用登记数据进行预测性研究的优势包括样本量大、患者具有代表性 (尤其是基于人群的癌症登记)。大型数据库可用性高，尤其适用于研究少数预测因素与生存期之间的预测关系。</p>
<h3 id="食管癌的手术死亡率"><a href="#食管癌的手术死亡率" class="headerlink" title="食管癌的手术死亡率"></a><strong>食管癌的手术死亡率</strong></h3><p>研究者使用SEER-Medicare数据库分析了1327例食管癌手术患者的30天死亡率。预测因子包括年龄、合并基础疾病（心脏、肺、肾、肝和糖尿病）、术前放疗或联合放化疗，以及相对较低的医院容量。研究者将上述因素合并为一个简单的预后评分，在另一个登记处和一个医院系列中完成了模型的验证。</p>
<h3 id="巢式病例对照研究"><a href="#巢式病例对照研究" class="headerlink" title="巢式病例对照研究"></a><strong>巢式病例对照研究</strong></h3><p>有时候，前瞻性设计的巢式病例-对照研究是进行预测研究的高效选择。当研究结局相对罕见时，病例-对照设计尤其具有吸引力，例如乳腺癌的发病率。例如，如果30天死亡率为1%，那么只需要研究所有死亡患者的预测因素就足够了，而对照组只需要研究4%的人（1:4的病例-对照比例）。选择随机选取的对照组与病例进行比较。然而，在巢式病例对照研究中，评估预测因素是回顾性的，这是该研究方法的一个局限性。如果开发了一个预测模型，则必须在最终计算概率时调整平均结局的发生率，而回归系数可能基于病例-对照研究。</p>
<h3 id="示例：大血管手术的围术期死亡率"><a href="#示例：大血管手术的围术期死亡率" class="headerlink" title="示例：大血管手术的围术期死亡率"></a><strong>示例：大血管手术的围术期死亡率</strong></h3><p>一个有趣的例子是分析接受大血管手术患者围手术期死亡率的研究。研究人员通过详细回顾所有病例（死亡患者）和部分对照组（存活患者）的病历资料，确定了预测因素。对照组患者的手术时间紧靠病例组之前或之后，从而实现了病例与对照组的 1:2配比。</p>
<h2 id="诊断研究"><a href="#诊断研究" class="headerlink" title="诊断研究"></a><strong>诊断研究</strong></h2><p>诊断研究最常采用横断面研究设计，将患者的预测性特征与潜在诊断联系起来。研究组依据特定症状或体征定义，这些症状或体征使受试者疑似患有特定(目标)疾病。通常，受试者将在短时间内接受相关测试，以确定是否存在目标疾病。</p>
<h3 id="横断面研究设计和多变量建模"><a href="#横断面研究设计和多变量建模" class="headerlink" title="横断面研究设计和多变量建模"></a><strong>横断面研究设计和多变量建模</strong></h3><p>理想情况下，诊断研究应考虑一组定义明确的疑似患有特定疾病的患者，例如急性心肌梗死。此时，该诊断研究类似于预后队列研究。队列由被怀疑患有 (而非实际患有) 疾病的患者定义。研究结局是潜在的诊断。因此，这样的研究可以被认为为是横断面研究，因为预测因果-结局关系是在一个时间点上进行研究的。几种特征可能预示潜在的诊断。对于模型，我们应该首先考虑简单的特征，例如人口统计学特征、从患者病史中获得的症状和体征。接下来，我们可能会考虑简单的诊断测试，最后是侵入性或昂贵的检查。诊断 (存在或不存在目标疾病) 应通过金标准来明确诊断。金标准检测的结果最好在不了解预测变量和诊断测试值的情况下进行解释。这样的盲法可以防止信息偏倚或纳入偏倚。诊断评估中常见的一个问题是所有预测特征的注册不完整。此外，并非所有患者都可能完成所有诊断检查，尤其是当他们被认为患目标疾病的风险较低时。此外，如果所使用的测试作为金标准而被选择性地进行，则可能导致结局评估不完整。这些问题在常规实践数据进行的诊断分析中尤为突出。因此，这种情况下前瞻性研究将更有用武之地，因为它们可以采用预先制定的方案进行系统诊断检查和金标准测试。</p>
<h3 id="示例：肾动脉狭窄的诊断"><a href="#示例：肾动脉狭窄的诊断" class="headerlink" title="示例：肾动脉狭窄的诊断"></a><strong>示例：肾动脉狭窄的诊断</strong></h3><p>研究者回顾性分析了接受腹主动脉造影检测隐匿性肾动脉狭窄的患者的心脏病学数据库。在开发队列中，635例患者中有128例观察到狭窄。如果患者因怀疑狭窄而接受血管造影，这20%的患病率可能被高估了。</p>
<h3 id="病例对照研究"><a href="#病例对照研究" class="headerlink" title="病例对照研究"></a><strong>病例对照研究</strong></h3><p>诊断研究有时会根据参考测试确定的目标疾病是否存在来选择患者，而参考测试则按照常规治疗进行。因此，没有参考标准的患者不会被选择。事实上，这相当于进行了病例-对照研究，其中病例是患有目标疾病的人，对照是未患病的人。这种设计存在一些局限性，特别是与所选患者对所有疑似患病患者的代表性相关。这与嵌套病例-对照研究不同。选择偏倚是另一个重要的限制。事实上，现在已经有了关于诊断研究中可能出现的偏倚的实证证据，特别是当病例-对照设计中包含非连续性患者、非代表性患者（严重病例与健康对照组相比）以及数据是回顾性收集的时候。</p>
<h3 id="诊断急性阑尾炎"><a href="#诊断急性阑尾炎" class="headerlink" title="诊断急性阑尾炎"></a><strong>诊断急性阑尾炎</strong></h3><p>C反应蛋白 (CRP) 常用于辅助诊断急性阑尾炎。对于 CRP 较高的患者，手术和病理结果作为参考标准。而 CRP 较低的患者通常不会立即手术，而是通过临床随访观察病情发展，再决定是否为阑尾炎。由于 CRP 水平升高不一定是由阑尾炎引起，轻微感染也可能导致 CRP 升高，但这类感染本身可能自行消退。因此，仅通过随访判断 CRP 较低患者是否为阑尾炎可能会漏掉一些真实患病者，导致 CRP 的诊断准确性被高估。</p>
<p>下期再见！</p>
<hr>
<p>供稿：圆圆</p>
<p>编排：Roger不言</p>
<hr>
<p><strong>往期推荐</strong></p>
<p><a href="https://link.zhihu.com/?target=https://mp.weixin.qq.com/s?__biz=MzkzNzMxNjgxMA==&mid=2247500319&idx=1&sn=2ba658195fea63a90fb0870ae13ad226&chksm=c293dabaf5e453ac50c62de7f4db3909627cbb430a706412abfa19318431b5633e83d9895a8e&scene=21%23wechat_redirect">临床预测模型|1.预测模型的应用有哪些？</a></p>
]]></content>
      <tags>
        <tag>临床预测模型</tag>
      </tags>
  </entry>
  <entry>
    <title>临床预测模型|1.预测模型的应用有哪些？</title>
    <url>/year/02181194.html</url>
    <content><![CDATA[<p>在之前的很多篇推送中，我们探讨了很多关于临床预测模型的内容。接下来，我们将结合统计大神Ewout W. Steyerberg的著作—Clinical Prediction Models, A Practical Approach to Development, Validation, and Updating，对临床预测模型的理论和实践进行系统的学习。<br>在这次的内容中，我们将系统了解预测模型在医疗领域中的应用。<br>预计阅读时间：26分钟。</p>
<hr>
<h2 id="医疗实践与研究"><a href="#医疗实践与研究" class="headerlink" title="医疗实践与研究"></a>医疗实践与研究</h2><p>在公共卫生领域，预测模型可能有助于针对患病或患病风险相对较高的受试者进行预防性干预。在临床实践中，预测模型可以告知患者及其治疗医生诊断的概率或预后结果。在诊断性检查中，预测可能有助于估计一种疾病存在的概率。在研究中，预测模型可能有助于设计干预研究。在随机试验的分析中，调整基线风险。在观察性的研究中，预测模型也有助于控制混杂变量。</p>
<span id="more"></span>

<h2 id="预测模型在公共卫生领域中的应用"><a href="#预测模型在公共卫生领域中的应用" class="headerlink" title="预测模型在公共卫生领域中的应用"></a>预测模型在公共卫生领域中的应用</h2><h3 id="增加预防性干预措施的针对性"><a href="#增加预防性干预措施的针对性" class="headerlink" title="增加预防性干预措施的针对性"></a>增加预防性干预措施的针对性</h3><p>预测模型可以预测人群中无症状受试者未来疾病的发生概率，例如众所周知的心血管疾病的弗雷明汉风险函数，其是当前多项预防性干预政策的基础。例如，他汀类药物治疗仅考虑用于心血管疾病风险相对较高的患者。同样，乳腺癌的预测模型也已开发出来，可以考虑对高风险人群进行更深入的筛查或化学预防。</p>
<h3 id="示例：乳腺癌预测模型"><a href="#示例：乳腺癌预测模型" class="headerlink" title="示例：乳腺癌预测模型"></a>示例：乳腺癌预测模型</h3><p>在1989年，Gail等人基于来自Breast Cancer Detection Demonstration Project（BCDDP）的病例对照数据，提出了著名的乳腺癌风险预测模型。BCDDP是美国国家癌症研究所（NCI）于1973年启动的一项大规模研究项目。该项目的目标是评估早期乳腺癌筛查的效果，以及使用乳房X线摄影术（即乳房X线照片，也称为乳房X光）进行早期乳腺癌筛查的可行性。<br>BCDDP的研究参与了约28万名女性，这些女性来自于30个不同的社区，并且在50岁至64岁之间。研究持续了6年，直到1979年。参与者被随机分配到两个组：一个接受乳房X线摄影术筛查的组，另一个是对照组，他们不接受筛查。这样设计是为了比较两组之间乳腺癌的发病率和死亡率。BCDDP的结果表明，接受乳房X线摄影术筛查的女性群体与未接受筛查的对照组相比，其乳腺癌的早期检测率有所增加，并且发现早期乳腺癌的女性死亡率较低。这些发现为乳腺癌筛查的推广提供了重要的科学证据，促进了早期诊断和治疗的实践。BCDDP为今后的乳腺癌筛查项目提供了基础，对于乳腺癌早期检测和治疗的重要性有着深远的影响。其他乳腺癌的风险预测模型还包括克劳斯模型（Claus Model）。Claus 模型以研究人员David J. D. Cunningham、Isaac D. Sasco、和Claus 和 Edward A. Cornwall 的名字命名。这个模型主要基于家族史，特别是家族中是否有一级亲属（母亲、姐妹或女儿）患有乳腺癌来预测个体患乳腺癌的风险。模型的基本假设是乳腺癌风险与家族史中患者的数量和关系的程度相关。一般来说，克劳斯模型根据患者家族中患有乳腺癌的亲属数量和患者年龄等因素，来估计患者未来发展乳腺癌的风险。具体而言，该模型可以根据家族史的情况将患者分为不同的风险组别，并给出相应的患病概率。与Gail模型不同，克劳斯模型需要输入一级或二级亲属乳腺癌确诊时的确切年龄。<br>一些乳腺癌是由乳腺癌易感基因（BRCA）突变引起的，称为遗传性乳腺癌。可疑的遗传性乳腺癌家族史包括许多乳腺癌和卵巢癌病例，或者家族成员中乳腺癌患者年龄在50岁以下。目前已经有简单的表格用于根据个人和家族史的特定特征来确定BRCA突变的风险。另一个模型更详细地考虑了家族史（BRCAPRO）。它明确使用家族中的遗传关系，因此被标记为孟德尔模型。计算基于贝叶斯定理。风险模型在乳腺癌中可能有两个主要作用：预测无症状女性的乳腺癌风险和预测BRCA基因突变的可能性。这些模型在预测因素方面有一些共同之处，当然也存在一些不同之处。有各种措施可以减少乳腺癌风险，包括行为干预（如锻炼、体重控制和饮酒）、预防性手术和医疗干预（如使用他莫昔芬）。</p>
<p><img src="https://pic4.zhimg.com/80/v2-07e06999d4c2b840d7b9bc768b25a7ff_1440w.webp" alt="四种乳腺癌预测模型的危险因素"></p>
<h2 id="预测模型在临床实践中的应用"><a href="#预测模型在临床实践中的应用" class="headerlink" title="预测模型在临床实践中的应用"></a>预测模型在临床实践中的应用</h2><h3 id="医疗决策支持"><a href="#医疗决策支持" class="headerlink" title="医疗决策支持"></a>医疗决策支持</h3><p>预测模型可能有助于估计潜在疾病的概率，以便我们进一步决策。当某种诊断的可能性极低时，通常无需进一步检查，而当诊断尚未充分确定以做出治疗决策时，可能需要进行更多检查。进一步的检查通常涉及一项或多项不完善的检查（灵敏度低于 100%，特异性低于 100%）。理想情况下，可以使用金标准检查（灵敏度 &#x3D; 100%，特异性 &#x3D; 100%）。然而在临床实践中，许多参考检查并不是真正的“金标准”，尽管它们被用作确定受试者是否患有该疾病的决定性指标。某些情况下，所谓的“金标准”可能不适合应用于所有怀疑患有该疾病的受试者，因为它可能对人体有害（例如侵入性检查）或者相当昂贵。</p>
<h3 id="示例：肾动脉狭窄的预测模型"><a href="#示例：肾动脉狭窄的预测模型" class="headerlink" title="示例：肾动脉狭窄的预测模型"></a>示例：肾动脉狭窄的预测模型</h3><p>肾动脉狭窄是高血压的罕见原因。肾动脉造影是诊断肾动脉狭窄的金标准，是一种侵入性且花费较高的诊断性操作。既往有研究基于患者的临床特征开发了肾动脉狭窄的预测模型，用于选择进行肾血管造影的患者。对 477 名接受肾血管造影的高血压患者的数据进行逻辑回归分析。选择年龄、性别、动脉粥样硬化性血管疾病、近期高血压发病、吸烟史、体重指数、腹部血管杂音、血清肌酐浓度和血清胆固醇水平作为预测因子。回归模型的诊断准确性与肾血管造影的性能相似，敏感度为 72%，特异度为 90%。作者基于以上模型开发了一个交互式的 Excel 程序用于估计每个患者的肾动脉狭窄概率。下图显示了一个45岁男性近期发病的高血压的例子。该患者吸烟，无动脉粥样硬化性血管疾病的迹象，BMI&lt;25，无腹部血管杂音，血清肌酐为112µmol&#x2F;L，血清胆固醇正常。计算其总得分为11分，对应于狭窄的概率为25%。根据精确的逻辑回归计算，该概率为28% [95%置信区间17-43%]。</p>
<p><img src="https://pic3.zhimg.com/80/v2-17daf9e226abdd9f93c10a03ded99bc2_1440w.webp" alt="肾动脉狭窄预测模型"></p>
<h3 id="确定干预阈值"><a href="#确定干预阈值" class="headerlink" title="确定干预阈值"></a>确定干预阈值</h3><p>决策分析是一种权衡决策利弊的方法。对于在诊断工作完成后开始治疗的情况，一个关键概念是治疗门槛。该门槛被定义为治疗的预期益处等于避免治疗的预期益处的概率。如果诊断的概率低于门槛值，则首选不推荐治疗；如果诊断的概率高于门槛值，那么推荐治疗。门槛值由假阴性与假阳性决策的相对权重确定。如果假阳性决策远不如假阴性决策重要，则门槛值较低。例如，对于过度治疗的风险为0.1%，而正确治疗的好处为10%，意味着接近1%的门槛值（比例为1:100，门槛概率为0.99%）。另一方面，如果假阳性决策会带来严重的风险，则门槛值应该更高。例如，与过度治疗相关的伤害为1%，则门槛值为9.1%（比例为1:10）。门槛概念的进一步细节将在决策曲线评估预测模型性能时进行讨论。</p>
<p><img src="https://pic1.zhimg.com/80/v2-29cb85cea9e56e798e715c6727c19484_1440w.webp" alt="在治疗决策时，当过度治疗的危害为0.1%（左上面板）或1%（右上面板）时，治疗阈值概念变得至关重要。如果有一个具有完美灵敏度和特异性的金标准，其固定的危害风险为0.1%，那么该指标表明患病概率在 0.9% 到 90% 之间（左下图）"></p>
<p>可以通过临床预测模型来估计疾病的概率。需要注意的是，只有当所有诊断检查（包括针对该疾病的所有可用检验）都完成时，才适用单一治疗阈值。如果仍然可以进行更多检验，则需要进行更复杂的决策分析以确定检查和治疗的最佳选择。然后我们有两个阈值：一个较低的阈值来识别那些没有接受治疗和没有接受进一步检查的患者；还有一个更高的阈值来确定谁将在没有进一步检查的情况下接受治疗。在这两者之间的是那些将受益于进一步检查的人。</p>
<h3 id="预测深静脉血栓"><a href="#预测深静脉血栓" class="headerlink" title="预测深静脉血栓"></a>预测深静脉血栓</h3><p>Wells临床预测规则结合了九个体征、症状和风险因素，将患者分为深静脉血栓（DVT）患病概率低、中等或高的类别。这个规则与单个特征相比可以更好地分层患者患有DVT的概率。对于低分险的患者（例如得分 ≤ 1），可以通过单独超声或血浆D-二聚体阴性结果排除DVT。对于DVT风险较高的患者（得分 &gt; 1）的患者则需要同时超声检查和D-二聚体检查阴性才能排除DVT风险，其具体工作算法如下：</p>
<p><img src="https://pic3.zhimg.com/80/v2-371c2f58bc005a183670b7748c276262_1440w.webp" alt="通过 D-二聚体检测和超声成像疑似 DVT 患者的可能诊断算法"></p>
<h3 id="评估治疗强度"><a href="#评估治疗强度" class="headerlink" title="评估治疗强度"></a>评估治疗强度</h3><p>预后估计在确诊后指导决策也很重要。决策包括更高或更低强度的治疗方法。基于预后的决策框架与之前讨论的基于诊断概率的框架非常相似。只有在预期获得实质性收益的情况下，才应给予患者治疗，这种收益应超过任何风险和副作用。这方面的一个经典案例是抗凝剂使用和心房颤动的风险的关系。抗凝剂在降低非风湿性心房颤动患者中风风险方面非常有效。然而，使用这些药物会增加严重出血的风险。因此，在考虑治疗之前，中风的风险必须超过出血的风险。这两种风险可能取决于预测因子。类似的分析已经用于急性心肌梗死患者溶栓治疗的适应症。</p>
<h3 id="示例：定义一个癌症预后不良的亚组"><a href="#示例：定义一个癌症预后不良的亚组" class="headerlink" title="示例：定义一个癌症预后不良的亚组"></a>示例：定义一个癌症预后不良的亚组</h3><p>我们将高剂量化疗（HD-CT）作为一线治疗，以提高非精原细胞性睾丸癌患者的生存率。一些非随机试验报道，与标准剂量（SD）化疗（包括博莱霉素、依托泊苷和顺铂）相比，接受自体干细胞支持的一线治疗（包括依托泊苷、异环磷酰胺和顺铂）的患者生存率更高。然而，HD-CT与治疗期间（如粒细胞减少、贫血、恶心&#x2F;呕吐和腹泻）、治疗后短期（如肺毒性）和治疗后长期（如白血病和心血管疾病）更严重的毒性发生相关。因此，HD-CT只适用于预后相对较差的患者。我们可以通过权衡预期的益处与危害来确定这种预后不良群体的阈值。HD-CT治疗的益处在于降低癌症死亡的绝对风险。如果我们假设处于最高风险的患者获益最大，那么益处随着癌症死亡风险呈线性增加。危害是由于治疗而导致治疗死亡的绝对风险增加（例如，与毒性相关）。假设治疗的毒性与预后无关，那么所有患者的危害水平相同。当患者的癌症死亡风险高于阈值时，即益处大于危害时，此时应该给予患者更为积极的治疗。</p>
<p><img src="https://pic1.zhimg.com/80/v2-5468faa39308624ee5d5a6f49920f908_1440w.webp" alt="权衡治疗利弊的示意图。治疗的益处（降低绝对风险）随着癌症特异性死亡率的增加而增加（相对风险设置为0.7）。治疗的危害（额外的绝对风险，例如，由于治疗的毒性）被假定为固定在4%。只有当给予标准治疗的癌症特异性死亡率超过11% 的阈值时，才会出现净效益。   "></p>
<h3 id="治疗的成本效益"><a href="#治疗的成本效益" class="headerlink" title="治疗的成本效益"></a>治疗的成本效益</h3><p>治疗的成本效益直接取决于预后。如果收益很小（对于低风险的患者）和成本很高（例如，对所有患者产生相同的药物成本），那么治疗可能不具有成本效益。例如，他汀类药物治疗只适用于心血管风险增加的患者。而更积极的溶栓治疗只应用于那些有30天死亡风险增加的急性心肌梗死患者。可以发现许多其他的例子，假设治疗的相对益处在不同的风险群体中是恒定的，因此绝对收益随着风险的增加而增加。在上图中，我们假设伤害恒定，而获益与死亡风险相关。后者同时依赖于有效的预后模型与单一治疗的相对治疗效果。可以考虑对这种方法进行扩展，如果对更大的数据集进行建模，则具有更高的可靠性。具体来说，我们在患者亚组中寻找不同的治疗效果。然后放宽相对获益固定的假设：一些患者可能对某种治疗反应相对较好，而另一些则没有。年龄或特定疾病类型等患者特征可能与治疗反应相互作用。药物的作用可能被药物代谢影响，例如，由细胞色素 P450酶和药物转运蛋白介导。药物基因组学领域的研究人员旨在进一步了解个体患者的基因构成（基因型）与药物治疗反应之间的关系，以便更好地预测治疗反应。成本效益将根据治疗反应的不同可能性而有所不同。但应该注意的是，在没有生物学机制&#x2F;原理的情况下，这种亚组效应很可能是虚假的。即使存在生物学机制&#x2F;原理，也需要足够大的样本量来保证亚组分析的统计效能。这些远远超过了检测治疗的主效应所需的样本量。在最佳情况下，样本大小需要是四倍大才能检测到与主效应相同大小的交互作用。如果我们假设交互作用是主效应大小的一半，则需要16倍的样本量。 </p>
<h3 id="延迟治疗"><a href="#延迟治疗" class="headerlink" title="延迟治疗"></a>延迟治疗</h3><p>在医疗实践中，预测模型可以为患者及其亲属提供信息，使他们对病程有现实的预期。有时可以采取保守的方法，即遵循疾病的自然史。例如，如果检测到“惰性”的前列腺癌，许多男性可能会选择观察等待策略。或者，如果女性具有相对有利的特征，她们可能会对怀孕机会感到放心。</p>
<h3 id="示例：自然怀孕的机会"><a href="#示例：自然怀孕的机会" class="headerlink" title="示例：自然怀孕的机会"></a>示例：自然怀孕的机会</h3><p>根据三项预测不育夫妇自然妊娠的模型研究的数据，开发了一种“综合模型”，用于预测在随访1年内活产的自发受孕。这种综合模型比原始模型具有更广泛的经验基础。预测因素包括一些容易获得的特征，例如不孕持续时间、女性年龄、原发性或继发性不孕症、活动性精子的百分比，以及这对夫妇是由全科医生还是妇科医生转诊。使用该模型，可以很便捷地计算出一年内自然怀孕的概率。（首先计算预后分数。然后，预后分数对应于一个概率，可以从图表中读取）。</p>
<p><img src="https://pic2.zhimg.com/80/v2-a97d74e116eed3b930720c639729b8c1_1440w.webp" alt="用于估计摄入后 1 年内自然怀孕并活产的评分表。上半部分：计算分数；下半部分：预测1年妊娠率。"></p>
<h3 id="手术决策"><a href="#手术决策" class="headerlink" title="手术决策"></a>手术决策</h3><p>在手术中，通常会采取短期风险来降低长期风险。短期风险包括并发症和死亡率。手术旨在减少自然病程中可能发生的长期风险。紧急情况下的手术包括创伤手术和动脉瘤破裂（动脉扩张）等疾病相关的手术。择期手术针对许多情况进行，即使对于这样有计划和准备充分的手术，短期风险和负担也绝不会为零。在肿瘤学中，手术风险增加通常会导致选择风险较低的治疗，例如化疗或放疗，或姑息治疗。例如，在许多癌症中，老年患者和合并症较多的患者较少接受手术。目前已经开发了许多预后模型来估计手术的短期风险，例如30天死亡率。这些模型的复杂性和准确性各不相同。此外，尽管很难找到不需要手术干预治疗适合疾病自然病程的患者群体，仍然有一些针对各种疾病长期风险的模型被开发。</p>
<h3 id="示例：有风险的心脏瓣膜置换的手术决策问题"><a href="#示例：有风险的心脏瓣膜置换的手术决策问题" class="headerlink" title="示例：有风险的心脏瓣膜置换的手术决策问题"></a>示例：有风险的心脏瓣膜置换的手术决策问题</h3><p>Björk–Shiley convexo-concave (BScc) 机械心脏瓣膜在报告机械故障（出口支柱断裂）后于1986年退出市场。截至该产品退出市场时，全世界已经植入了大约86,000个BScc瓣膜。出口支柱突然断裂通常是致命的。因此，可以考虑用另一个更安全的瓣膜进行预防性置换，以避免断裂的风险。而决策分析是衡量因出口支柱断裂导致的长期预期寿命减少与短期手术死亡风险非常有用的方法。<br>出口支柱断裂风险导致的长期预期寿命损失取决于三个方面：（1）患者存活情况下，每年发生断裂的风险；（2）断裂的致死率；（3）年死亡风险（生存）。这种预期寿命的长期减少必须与手术死亡的风险进行权衡。<br>如果患者在手术中幸存下来，则假定断裂风险降至零。根据1979年至1985年间荷兰2,263名植入BScc瓣膜的患者的随访经验，考虑了随访期间发生的50例断裂和883例死亡患者（不包括断裂）。针对各个方面开发了预测回归模型。断裂风险是这个决策问题的关键因素。出现结局事件的患者样本量较少使得预测建模具有挑战性，预测模型的各个变量也需要关注。一个相对详细的模型包括四个传统预测因素，年龄、位置（主动脉&#x2F;二尖瓣）、瓣膜类型（70°开角瓣膜的风险高于 60°瓣膜）和尺寸（瓣膜越大风险越高），以及两个生产特征。断裂的死亡率取决于患者的年龄和位置（主动脉位置的瓣膜死亡率更高）。存活率与年龄、性别、瓣膜位置和植入后时间有关。手术风险根据年龄和瓣膜位置进行建模。该决策分析的结果很大程度上取决于年龄：只有对于年轻患者才建议进行置换手术，因为他们手术风险较低，并且由于存活时间较长，骨折的长期影响更大。此外，瓣膜的位置会影响所有四个结局（手术风险、生存、断裂和死亡）。</p>
<p><img src="https://pic2.zhimg.com/80/v2-c24a579cf10fa730b7ebf9abe3098a8d_1440w.webp" alt="有风险心脏瓣膜置换的短期与长期风险的手术决策示意图。正方形表示一个决策，圆圈代表一个机会节点。需要对四种概率进行预测：手术死亡率、长期生存率、瓣膜破裂和瓣膜断裂死亡率。"></p>
<p><img src="https://pic3.zhimg.com/80/v2-70f1b4a17486bb7cb2ec77edb0c8b03e_1440w.webp" alt="替换风险性心脏瓣膜决策分析的患者特征"></p>
<h2 id="预测模型在医学研究中的应用"><a href="#预测模型在医学研究中的应用" class="headerlink" title="预测模型在医学研究中的应用"></a>预测模型在医学研究中的应用</h2><p>在医学研究中，预测模型有以下用途。在实验研究中，比如随机对照试验，预后基线特征可能有助于患者的纳入和分层，并改善统计分析。在观察性研究中，充分控制混杂因素是至关重要的。</p>
<h3 id="随机对照试验中的纳入和分层"><a href="#随机对照试验中的纳入和分层" class="headerlink" title="随机对照试验中的纳入和分层"></a>随机对照试验中的纳入和分层</h3><p>在随机临床试验（RCTs）中，预后估计可用于选择研究对象。传统上，一组包含和排除标准被应用于定义RCT的研究对象。这些标准旨在根据预期结果创建更同质的群体。患者必须满足所有纳入标准，而非排除标准。或者，一些预后标准可以结合在预测模型中，根据个性化的预测进行选择。这会导致更精细的选择。在RCTs中，通常建议对主要预后因素进行分层。通过这种方式，试验组之间基线的预后得以被平衡。这有助于治疗结果的简单、直接比较，特别是对于较小的RCTs，可能更加容易出现一些基线不平衡。预后模型可以细化患者的这种分层，特别是当许多预后因素是已知的情况下。</p>
<h3 id="示例：创伤性脑损伤的病例选择"><a href="#示例：创伤性脑损伤的病例选择" class="headerlink" title="示例：创伤性脑损伤的病例选择"></a>示例：创伤性脑损伤的病例选择</h3><p>依据创伤性脑损伤的两个预测因子进行预后选择,在选择创伤性脑损伤 (TBI) 患者进行随机对照试验时。65 岁以上的患者和瞳孔无反应的患者常因预后很差而通常被排除在外。现实情况中，我们发现满足任一上述标准的患者在 6 个月的随访中死亡率高于 50%。因此，我们可以简单地只选择那些 65 岁以下且至少有一侧瞳孔反应的患者。</p>
<p><img src="https://pic1.zhimg.com/80/v2-72db249a5faddfb404cb97e4b72dcfec_1440w.webp" alt="根据瞳孔对光反射和年龄，对7143例重度或中度创伤性脑损伤患者的预后进行分析"></p>
<p>我们还可以基于单个指标使用预后模型来更有效地选择患者纳入研究。一个简单的回归模型中可以用“年龄”和“瞳孔反应”更详细地计算死亡概率。如果我们的目标是排除那些预测风险超过50%的患者，这将导致无任何瞳孔反应的患者的年龄限制为30岁，而有任何瞳孔反应的患者的年龄限制为76岁。因此，如果我们只想纳入那些死亡风险 &lt;50% 的患者，则始终可以纳入30 岁以下的患者，并且如果至少有一侧瞳孔存在对光反射，则可以纳入65 至 75 岁之间的患者 。</p>
<p><img src="https://pic3.zhimg.com/80/v2-5094ad9999640332183a56f1d09b3a5e_1440w.webp" alt="以传统方式 (A) 和根据预后模型（6 个月死亡率 &lt; 50% 的概率，B）选择符合 2 个标准（年龄和瞳孔对光反射）的患者"></p>
<h3 id="RCT中的协变量调整"><a href="#RCT中的协变量调整" class="headerlink" title="RCT中的协变量调整"></a>RCT中的协变量调整</h3><p>预测模型更重要的作用是在RCT分析中的预后基线特征的作用。随机化的优势在于，在观察到的和未观察到的基线特征方面，在治疗组之间产生了可比性。因此，在RCT中不会出现系统的混杂因素。但是一些观察到的基线特征可能与结局密切相关。对这种协变量进行调整有几个优点：<br>&#x3D;&#x3D;减少组间随机不平衡造成的治疗效果估计中的任何失真&#x3D;&#x3D;<br>&#x3D;&#x3D;增加检测治疗效果的统计效能&#x3D;&#x3D;</p>
<p><img src="https://pic2.zhimg.com/80/v2-53465a85261ac786bb44864d4aab9209_1440w.webp" alt="随机对照试验中基线特征的作用示意图。通过随机化，基线特征、观察到或未观察到的特征与治疗之间没有系统的联系。基线特征仍然很重要，因为它们通常是预后的预测因素。"></p>
<p><img src="https://pic1.zhimg.com/80/v2-e212cb128dd98372910e0bce44d3be04_1440w.webp" alt="当预测因子完全平衡时，在线性和广义线性模型（如逻辑回归）的估计和检验中对预测因子的调整进行比较
值得注意的是，协变量调整对于线性回归模型和广义线性模型（例如逻辑回归、Cox 回归）的作用不同。"></p>
<p>对于随机临床试验，随机化保证估计治疗效果的偏倚先验为零，不会因观察到或未观察到的基线特征而失真。然而，可能会出现随机不平衡，产生这样的问题：如果两组完全平衡，治疗效果会怎样？我们可能认为这种扭曲是一种后验偏移，因为它影响解释的方式与观察流行病学研究类似。<br>回归分析可以纠正这种随机不平衡。当回归模型中考虑的预测变量没有发生不平衡时，调整后和未调整的治疗效果估计值预计将相同。线性回归分析中确实如此。值得注意的是，在逻辑回归等广义线性模型中，即使预测变量完全平衡，调整后和未调整的治疗效果估计值也不同。调整后的效果预计将进一步远离零（中性值，OR进一步远离1）。这种现象被称为效应估计的“不可折叠性”，或“分层效应”。线性回归不会发生这种情况。<br>通过线性回归，对重要预测变量的调整可以提高估计治疗效果的准确性，因为结局的部分方差是由预测变量解释的。相反，在逻辑回归等广义线性模型中，治疗效果的标准误差总是随着调整而增加。在线性回归中，调整分析为治疗效果分析提供了更多依据，因为治疗效果的标准误差更小。对于逻辑回归等广义线性模型，调整对效能的影响并不明确。然而，已证明治疗效果估计的预期值增加超过标准误差。因此，与未调整的分析相比，调整后的逻辑回归分析中检测治疗效果的效能更高，类似于线性回归模型。    </p>
<h3 id="通过协变量调整来增加效能"><a href="#通过协变量调整来增加效能" class="headerlink" title="通过协变量调整来增加效能"></a>通过协变量调整来增加效能</h3><p>协变量调整导致的效能增加取决于基线协变量（预测因子）和结局之间的相关性。对于连续性结局，这种相关性可以用Pearson相关系数(r)来表示。样本量可以减少 1−r2，以通过协变量调整分析获得与未调整分析相同的统计效能 。非常强的预测变量可能具有 r &#x3D; 0.7 (r2 &#x3D;50%)，例如血压等重复测量的基线协变量或问卷分数。所需的患者数量大约减少一半。r &#x3D; 0.3 时节省不到 10% (r2&#x3D; 9%)。在二分类结局的实证评估中也得到了类似的结果，其中Nagelkerke’s R2被用来表示预测因子和结局之间的相关性。在急性心肌梗死患者和脑外伤患者的死亡率模拟中，样本量的减少略小于1-R2。</p>
<p><img src="https://pic4.zhimg.com/80/v2-3f6d5c1c7b4338ec9bd95a7938cdaf2f_1440w.webp"></p>
<h3 id="示例：GUSTO-III-试验分析"><a href="#示例：GUSTO-III-试验分析" class="headerlink" title="示例：GUSTO-III 试验分析"></a>示例：GUSTO-III 试验分析</h3><p>GUSTO-III试验主要纳入急性心肌梗死患者。主要结局是30天死亡率。该试验预先指定了一个预后模型对干预效果进行初步分析。该模型结合了年龄、收缩压、Killip分级、心率、梗死位置和年龄与Killip分级的交互作用。在之前的GUSTO-I 试验中发现这些预测因子包含了30 天死亡率模型的 90% 的预后信息。如上所述，有相当多的理由可以更广泛地使用这种协变量调整。    </p>
<h3 id="观察性研究中的预测模型"><a href="#观察性研究中的预测模型" class="headerlink" title="观察性研究中的预测模型"></a>观察性研究中的预测模型</h3><p>观察性研究的主要目的是估计因果效应。混杂因素是观察性研究的流行病学分析中主要关注的问题。当比较治疗时，由于缺乏随机化，各组之间的基线信息通常参差不齐。具有特定特征的受试者比其他受试者更有可能接受某种治疗（“指示混淆”）。如果这些特征也影响结局，则治疗效果的直接比较是有偏移的，并且可能仅仅反映缺乏基线可比性（“混杂”）。除了治疗之外，还可以研究其他因素的病因学影响。通常来说，当随机化不可能时，若观察性研究是唯一可行的设计。处理混杂因素是此类分析中的一个重要步骤。回归分析是控制治疗组之间基线不平衡的常用方法，例如逻辑回归或 Cox 回归 。许多基线特征可以同时调整。与随机对照试验相反，我们只能平衡观察到的基线特征，理想情况下没有测量误差。我们应该特别担心任何未知的协变量，这些协变量可能会因与治疗选择和结局的关联而成为混杂因素。</p>
<p><img src="https://pic3.zhimg.com/80/v2-79663837385415dc5412e707d766a8a6_1440w.webp" alt="观察性研究中基线特征调整的示意图。通过调整，我们的目标是纠正观察到的基线特征和结局之间的系统联系，从而回答以下问题：如果治疗组之间观察到的基线特征相似，治疗效果如何？"></p>
<h3 id="倾向性评分"><a href="#倾向性评分" class="headerlink" title="倾向性评分"></a>倾向性评分</h3><p>当结局相对罕见时，用回归分析进行调整就会出现问题。这可能会导致调整分析中组间差异的估计存在偏差且效率低下。另一种方法是使用倾向评分，这在上面的情况中特别适用。倾向性评分定义了在给定一组混杂因素的情况下受试者接受特定治疗（“Tx”）的概率：p(Tx | 混杂因素)。为了计算倾向性评分，通常在逻辑回归模型中使用混杂因素来预测治疗，而不包括治疗结局。随后，倾向性得分在第二阶段用作汇总混杂因素。第二阶段的常见方法是倾向性评分匹配、倾向性评分分层（通常按四分位数）以及将倾向性评分与治疗纳入结局回归模型中。实证比较表明倾向性评分方法并没有优于传统的回归分析。相比之下，模拟研究表明，相对于混杂因素的数量，在结局很少的情况下，倾向性得分对于研究有一定益处。</p>
<p><img src="https://pic2.zhimg.com/80/v2-0506e83b4fc5578edae25d2653020861_1440w.webp" alt="观察性研究中基线特征的倾向性评分调整的示意图。"></p>
<h3 id="示例：他汀类药物治疗效果"><a href="#示例：他汀类药物治疗效果" class="headerlink" title="示例：他汀类药物治疗效果"></a>示例：他汀类药物治疗效果</h3><p>他汀类药物对急性心肌梗死（AMI）发生的影响已在随机对照试验和观察性研究中进行了研究。对1994年至1998年期间任何时候记录的LDL&gt;为130mg&#x2F;dl的社区健康计划成员进行倾向性评分分析。使用倾向性得分匹配开始使用他汀类药物治疗的患者和未开始他汀类药物治疗的患者。倾向评分预测了开始使用他汀类药物的概率。采用包含52个变量和6个二次项的logistic回归模型估计得分。开始使用他汀类药物患者与具有相似接受治疗倾向的未开始使用他汀类药物患者匹配（倾向误差在 0.01 以内）。找不到合适的匹配对象的患者将会被排除。在 4144 个使用他汀类药物患者中留下了 2901 个（70%）。4144 名患者的已知冠心病危险因素的患病率高于不匹配的未开始使用他汀类药物的患者。对这些未匹配队列的随访发现，启动他汀类药物治疗的患者中有325例AMI，未启动的患者中有124例AMI（风险比 2.1）。倾向性得分匹配队列 (n &#x3D; 2901) 在 52 个匹配基线特征中有51个特征非常相似。开始使用他汀类药的患者中有 77 例 AMI，而匹配的未开始他汀治疗的患者中有 114 例发生 AMI（风险比 0.69）。作者得出的结论是，该社区健康计划的成员使用他汀类药物有利于 AMI 的发生，但需要警示的是，不属于模型部分的预测因子可能在倾向性评分匹配的队列之间保持不平衡，从而导致残余混杂。</p>
<p><img src="https://pic1.zhimg.com/80/v2-c8819c11d119c40088428f0089960c44_1440w.webp" alt="他汀类药物对急性心肌梗死发生的影响"></p>
<h3 id="不同数据来源的比较"><a href="#不同数据来源的比较" class="headerlink" title="不同数据来源的比较"></a>不同数据来源的比较</h3><p>预测模型的另一个应用领域是比较不同医院（或其他护理提供者）的结局。医疗保健提供者的质量是根据其结局进行比较的，这些结局被视为绩效指标。提供者之间的简单比较显然可能会因病例组合的差异而产生偏移，例如，学术中心可能会看到更严重的患者，这导致患者整体结局较差。在这种比较中需要预测模型来进行案例组合调整。另一个问题是提供的单位可能较小并且进行了多次比较。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总之，预测模型的潜在应用领域，包括公共卫生（预防干预的目标）、临床实践（诊断检查、治疗决策、共同决策）和医疗研究（随机对照试验的设计和分析） ，观察性研究中的混杂因素调整）。从模型中获取预测必须与深入了解疾病机制和病理生理过程分开。 </p>
<hr>
<p>供稿：圆圆<br>编排：Roger不言</p>
]]></content>
      <tags>
        <tag>临床预测模型</tag>
      </tags>
  </entry>
</search>
